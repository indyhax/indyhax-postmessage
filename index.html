<!doctype html>
<html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>IndyHAX â€¢ postMessage</title>
<style>body{font-family:system-ui,Segoe UI,Roboto,Arial,sans-serif;max-width:900px;margin:40px auto;padding:0 16px}.card{border:1px solid #ddd;border-radius:12px;padding:18px;background:#fff}.muted{color:#666}button{padding:10px 12px;border-radius:10px;border:1px solid #111;background:#111;color:#fff}pre{margin-top:12px;padding:12px;border-radius:10px;background:#f6f8fa;border:1px solid #e5e7eb;white-space:pre-wrap}</style>
</head><body>
<h1>IndyHAX CTF - postMessage</h1>
<div class="card">
  <p class="muted">This page listens for messages and performs actions.</p>
  <p>Goal: send it the right message to reveal the flag.</p>
  <button id="open">Open helper window</button>
  <pre id="out">waiting...</pre>
</div>
<script>
  const out = document.querySelector('#out');
  window.addEventListener('message', (event) => {
    // Intentionally vulnerable: does not check event.origin
    if (event.data && event.data.type === 'GET_FLAG') out.textContent = 'INDYHAX{always_check_event_origin}';
  });
  document.querySelector('#open').addEventListener('click', () => {
    window.open('sender.html','sender','width=520,height=420');
  });
</script>
</body></html>
